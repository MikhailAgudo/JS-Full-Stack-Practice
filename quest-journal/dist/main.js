(()=>{"use strict";const e=e=>String(e),t=e=>e,s=e=>(e>3?e=3:e<1&&(e=1),e),n=e=>String(e),l=(()=>{let l=[];const a=e=>l[e],r=(e,t)=>l[e].getTask(t);return{quests:l,addQuest:e=>{let t=(e=>{let t=[],s=[];return{getTitle:()=>e,getTasks:()=>t,getTaskAmount:()=>t.length,getTask:e=>t[e],addTask:e=>{t.push(e)},removeTask:e=>{t.splice(e,1)},processSwap:e=>{s.length<2&&(e=>{s.push(e)})(e),s.length>=2&&(()=>{const e=s.shift(),n=s.shift();let l=t[e];t[e]=t[n],t[n]=l})()}}})(e=n(e));l.push(t)},removeQuest:e=>{l.splice(e,1)},getQuests:()=>l,getQuest:a,resetQuests:()=>{l=[]},addTask:(t,s)=>{let n=(e=>({getTitle:()=>title,getDescription:()=>e,getDueDate:()=>dueDate,getPriority:()=>priority,setTitle:e=>{title=e},setDescription:t=>{e=t},setDueDate:e=>{dueDate=e},setPriority:e=>{priority=e}}))(t=e(t));a(s).addTask(n)},removeTask:(e,t)=>{a(e).removeTask(t)},renameTitle:(t,s,n)=>{n=e(n),r(t,s).setTitle(n)},changeDescription:(t,s,n)=>{n=e(n),r(t,s).setDescription(n)},changeDate:(e,s,n)=>{n=t(n),r(e,s).setDueDate(n)},changePriority:(e,t,n)=>{n=s(n),r(e,t).setPriority(n)}}})(),a={render:(e,t,s)=>{let n=document.createElement("div");n.classList.add("task-container");let a=(e=>{let t=document.createElement("div");return t.classList.add("task-area"),t.textContent=e,t})(e.getDescription()),r=((e,t)=>{let s=document.createElement("button");return s.textContent="Done",s.addEventListener("click",(s=>{l.removeTask(e,t),i.renderTaskTab()})),s})(t,s);return n.appendChild(r),n.appendChild(a),n}},r=(()=>{let e=!1,t=!1;const s=()=>{e=!1===e},n=()=>{t=!1===t},a=e=>{let t=document.createElement("input");return t.type="text",t.placeholder=e,t};return{getNewQuestPrompt:()=>e,getNewTaskPrompt:()=>t,createAddQuestButton:()=>{let e=document.createElement("button");return e.textContent="New Quest",e.addEventListener("click",(e=>{s(),i.renderQuestTab()})),e},createAddQuestPrompt:()=>{let e=document.createElement("div"),t=a("Quest name..."),n=(e=>{let t=document.createElement("button");return t.textContent="Add",t.addEventListener("click",(t=>{l.addQuest(e.value),s(),i.renderQuestTab()})),t})(t);return e.appendChild(t),e.appendChild(n),e},createAddTaskButton:()=>{let e=document.createElement("button");return e.textContent="New Task",e.addEventListener("click",(()=>{n(),i.renderTaskTab()})),e},createAddTaskPrompt:()=>{let e=document.createElement("div"),t=a("Task name..."),s=(e=>{let t=document.createElement("button");return t.textContent="Add",t.addEventListener("click",(()=>{let t=i.getDisplayedQuestIndex();l.addTask(e.value,t),n(),i.renderTaskTab()})),t})(t);return e.appendChild(t),e.appendChild(s),e}}})(),o=(()=>{const e=(t,s,n,l)=>{if(-1===n)return s;switch(l){case"title":s.unshift(t[n].getTitle());break;case"description":s.unshift(t[n].getDescription());break;case"date":s.unshift(t[n].getDueDate())}return e(t,s,n-=1,l)};return{transformToUIReadable:e,questsToTitles:e=>{let t=[];for(let s=0;s<e.length;s++){let n=e[s].getTitle();t.push(n)}return t}}})(),i=(()=>{let e=0,t=document.createElement("div"),s=document.createElement("div");const n=()=>(t.classList.add("quest-section"),t),i=()=>(s.classList.add("task-section"),s),d=()=>{h(),u();let e=v();c(e)},u=()=>{let e=null;e=!0===r.getNewQuestPrompt()?r.createAddQuestPrompt():r.createAddQuestButton(),t.appendChild(e)},c=e=>{for(let s=0;s<e.length;s++){let n=g(e,s);t.appendChild(n)}},g=(e,t)=>{let s=document.createElement("button");return s.textContent=e[t],s.dataset.index=t,s.addEventListener("click",(e=>{Q(t)})),s},T=()=>{k(),m();let e=b();p(e)},m=()=>{let e=null;e=!0===r.getNewTaskPrompt()?r.createAddTaskPrompt():r.createAddTaskButton(),s.appendChild(e)},p=t=>{for(let n=0;n<t.length;n++){let l=a.render(t[n],e,n);s.appendChild(l)}},h=()=>{t.innerHTML=""},k=()=>{s.innerHTML=""},Q=t=>{e=t,v(),d(),b(),T()},v=()=>o.questsToTitles(l.quests),b=()=>l.quests[e].getTasks();return{initializeJournal:()=>{let e=document.querySelector(".journal-section"),t=n(),s=i();e.appendChild(t),e.appendChild(s)},renderQuestTab:d,renderTaskTab:T,getDisplayedQuestIndex:()=>e,getQuestTitles:v,getTasks:b}})(),d=(()=>{let e=0,t=[];const s=()=>{localStorage.setItem("questLength",e)},n=e=>{let s="quest"+String(e),l=t.shift();l=String(l),s+="taskLength",localStorage.setItem(s,l),0===t.length||n(e+1)},a=(e,t)=>{let s="quest";s+=e=String(e),localStorage.setItem(s,t.getTitle()),r(t.getTasks(),s)},r=(e,t)=>{console.log(e.length);for(let s=0;s<e.length;s++){let n=t;n+="task",n+=s,localStorage.setItem(n,e[s].getDescription())}},o=()=>{e=l.getQuests().length},i=()=>{let e=l.getQuests();t=[];for(let s=0;s<e.length;s++){let n=e[s].getTaskAmount();t.unshift(n)}};return{saveQuests:()=>{o(),i(),s(),n(0);for(let t=0;t<e;t++){let e=l.getQuest(t);a(t,e)}},resetStorage:()=>{localStorage.clear()}}})(),u=(()=>{let e=0,t=0;const s=t=>{e++,!0===t?console.log(`Test ${e} passed.`):console.log(`Test ${e} F-A-I-L-E-D.`)},n=e=>(!0===Array.isArray(e)&&(e=String(e)),e),a=(e,l)=>{((e,t)=>{console.log(`---${e} ~OUTPUT~ vs.`),console.log(`---${t} ~EXP.~`)})(e=n(e),l=n(l)),e===l?s(!0):(t++,s(!1))},r=()=>l.quests.length-1,i=()=>l.quests[r()].getTaskAmount()-1,u=()=>l.quests[r()].getTaskAmount(),c=e=>{l.addQuest(e);let t=r(),s=l.quests[t].getTitle();a(s,e)},g=e=>{let t=r();l.addTask(e,t);let s=l.quests[t].getTask(i()).getDescription();a(s,e)},T=e=>{l.removeTask(r(),i());let t=u();a(t,e)};return{testProcess:()=>{let e="Bandits Amassing",s="Vedivoll's Troubles",n="You must kill the bandits.",m="She lives in a hut somewhere in the mountains.";c(e),g(n),g(m),((e,t,s)=>{let n=l.quests[r()];n.processSwap(0),n.processSwap(1);let o=n.getTask(i()).getDescription();a(o,"You must kill the bandits.")})(),(e=>{let t=l.quests[r()].getTasks(),s=t.length-1,n=o.transformToUIReadable(t,[],s,"description");a(n,e)})([m,n]),(e=>{let t=l.quests[r()].getTasks(),s=t.length-1,n=o.transformToUIReadable(t,[],s,"description");a(n,e)})([m,n]),(e=>{let t=l.quests.length;a(t,1)})(),(e=>{let t=u();a(t,2)})(),d.saveQuests(),console.log("local"),console.log(localStorage.getItem("quest0task0")),console.log(localStorage.getItem("questLength")),console.log(localStorage.getItem("quest0taskLength")),d.resetStorage(),T(1),T(0),c(s),(e=>{let t=l.quests,s=t.length-1,n=o.transformToUIReadable(t,[],s,"title");a(n,e)})([e,s]),(e=>{l.removeQuest(r());let t=l.quests.length;a(t,1)})(),console.log(`Number of failed tests: ${t}`),l.resetQuests()}}})();i.initializeJournal(),u.testProcess(),(()=>{let e=i.getQuestTitles();i.renderQuestTab(e),i.getDisplayedQuestIndex(),i.renderTaskTab(i.getTasks())})()})();